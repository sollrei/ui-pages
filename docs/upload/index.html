<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <link rel="shortcut icon" href="/ui-pages/assets/favicon.ico"/>
    <title>ui</title>

    <!-- <link rel="stylesheet" href="//at.alicdn.com/t/font_1674032_ock2bes9o9.css"> -->
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2020678_qrr2g24en09.css">

    <!--[if lte IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.14/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.14/es5-sham.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.5/es6-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.5/es6-sham.min.js"></script>
    <![endif]-->
    
    <link rel="stylesheet" href="/ui-pages/dist/ui.css">
    <link rel="stylesheet" href="/ui-pages/css/page.css">

    <!--[if lt IE 10]>
    <link rel="stylesheet" href="/ui-pages/css/ie.css">
    <![endif]-->

    <script src="/ui-pages/dist/ui.js"></script>

    <script src="/ui-pages/assets/main.js"></script>
</head>


<body>
  <header></header>
  <div class="page-wrap page-layout">
    <div class="page-side">
      <nav class="page-nav">
  <div class="page-avatar">
    <svg viewBox="0 0 185 94" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414">
      <path d="M74.394 54.433s15.323-2.015 23.026 9.752c7.704 11.767 11.815 15.144 13.017 16.011 1.202.867-27.307-.577-36.043-25.763z" fill="#517791"></path>
      <path d="M39.392 46.534s16.23 5.418 18.197 20.864c1.968 15.447 4.424 20.801 5.2 22.247.776 1.445-26.904-13.807-23.397-43.111z" fill="#2d475a"></path>
      <path d="M113.701 48.408s15.576-5.893 26.56 4.55c10.984 10.443 16.129 12.972 17.604 13.585 1.475.613-28.788 6.13-44.164-18.135z" fill="#7ea6b8"></path>
      <path d="M36.483 41.551s16.304 6.979 28.466-3.632C77.11 27.307 82.7 24.851 84.297 24.266c1.597-.586-30.35-7.833-47.814 17.285zM81.824 51.306s13.794.419 19.585-10.724c5.792-11.144 9.142-14.512 10.132-15.39.991-.878-24.209 2.956-29.717 26.114zM119.334 44.153s12.351-4.257 13.738-16.065c1.388-11.808 3.223-15.914 3.805-17.024.583-1.109-20.439 10.741-17.543 33.089z" fill="#c0d2db"></path>
      <path d="M142.938 36.47s16.832 1.635 24.819-11.52c7.988-13.154 12.358-17 13.64-17.993 1.283-.993-29.841 1.646-38.459 29.513z" fill="#a9c2c8"></path>
    </svg>
  </div>

  
  
  
  <!-- <h4 class="pl-16 mt-8 ft-gray">Base</h4> -->
  <ul class="ft-content">
    
    <li class=""><a href="/ui-pages/docs/typography/"><span>Typography</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/layout/"><span>Layout</span></a></li>
    
  </ul>
  
  
  
  <!-- <h4 class="pl-16 mt-8 ft-gray">Form</h4> -->
  <ul class="ft-content">
    
    <li class=""><a href="/ui-pages/docs/button/"><span>Button</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/checkbox/"><span>Checkbox</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/input/"><span>Input</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/select/"><span>Select</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/range/"><span>Range</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/colorPicker/"><span>ColorPicker</span></a></li>
    
    <li class="active"><a href="/ui-pages/docs/upload/"><span>Upload</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/form/"><span>Form</span></a></li>
    
  </ul>
  
  
  
  <!-- <h4 class="pl-16 mt-8 ft-gray">Data</h4> -->
  <ul class="ft-content">
    
    <li class=""><a href="/ui-pages/docs/pagination/"><span>Pagination</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/table/"><span>Table</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/tag/"><span>Tag</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/badge/"><span>Badge</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/progress/"><span>Progress</span></a></li>
    
  </ul>
  
  
  
  <!-- <h4 class="pl-16 mt-8 ft-gray">Navigation</h4> -->
  <ul class="ft-content">
    
    <li class=""><a href="/ui-pages/docs/crumbs/"><span>Crumbs</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/menu/"><span>Menu</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/tab/"><span>Tab</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/tree/"><span>Tree</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/list/"><span>List</span></a></li>
    
  </ul>
  
  
  
  <!-- <h4 class="pl-16 mt-8 ft-gray">Notice</h4> -->
  <ul class="ft-content">
    
    <li class=""><a href="/ui-pages/docs/alert/"><span>Alert</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/modal/"><span>Modal</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/popup/"><span>Popup</span></a></li>
    
    <li class=""><a href="/ui-pages/docs/toast"><span>Toast</span></a></li>
    
  </ul>
  
</nav>
    </div>
    <div class="page-main">
      <main class="main ui-row" aria-label="content">
        
        <div class="page-code">
          <h1 id="upload">Upload</h1>

<blockquote>
  <p>IE10+</p>
</blockquote>

<h2 id="single-upload">Single Upload</h2>

<div class="bd-example" data-example-id="">
<div class="ui-upload-img" id="upload-demo">
  <label class="trigger"><i class="iconfont icon-plus"></i><input type="file" /></label>
  <div class="image hidden"></div>
</div>
</div>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui-upload-img"</span> <span class="na">id=</span><span class="s">"upload-demo"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"trigger"</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">"iconfont icon-plus"</span><span class="nt">&gt;&lt;/i&gt;&lt;input</span> <span class="na">type=</span><span class="s">"file"</span><span class="nt">&gt;&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"image hidden"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></div>

<h3 id="javascript">javascript</h3>

<div class="bd-example" data-example-id="">
<script>
var UploadHelper = ui.UploadHelper;
var up = UploadHelper('#upload-demo', {
  url: 'https://api.cooode.xyz/api/upload',
  success(data) {
    up.createSingleDom(data.data);
  }
});
</script>
</div>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">UploadHelper</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">UploadHelper</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">up</span> <span class="o">=</span> <span class="nx">UploadHelper</span><span class="p">(</span><span class="dl">'</span><span class="s1">#upload-demo</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://api.cooode.xyz/api/upload</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">success</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">up</span><span class="p">.</span><span class="nx">createSingleDom</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span></code></pre></div>

<blockquote>
  <p>默认有已上传的图片时的html结构</p>
</blockquote>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui-upload-img"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"trigger hidden"</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">"iconfont icon-plus"</span><span class="nt">&gt;&lt;/i&gt;&lt;input</span> <span class="na">type=</span><span class="s">"file"</span><span class="nt">&gt;&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"image"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">value=</span><span class="s">"https://picsum.photos/id/237/300/300"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://picsum.photos/id/217/300/300"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"option"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:;"</span> <span class="na">class=</span><span class="s">"js-change"</span><span class="nt">&gt;</span>替换<span class="nt">&lt;/a&gt;&lt;a</span> <span class="na">href=</span><span class="s">"javascript:;"</span> <span class="na">class=</span><span class="s">"js-clean"</span><span class="nt">&gt;</span>清除<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h2 id="multi-upload">Multi Upload</h2>

<div class="bd-example" data-example-id="">
<div class="ui-upload-multiple" data-drag="" id="upload-multi">
  <label class="trigger">
    <input type="file" multiple="" />
    <i class="iconfont icon-upload"></i>
    <div class="mt-20">点击或将文件拖拽到这里上传，最大支持20MB文件</div>
  </label>
</div>
<div class="js-progress"></div>
</div>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui-upload-multiple"</span> <span class="na">data-drag</span> <span class="na">id=</span><span class="s">"upload-multi"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"trigger"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">multiple</span><span class="nt">&gt;</span>
    <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"iconfont icon-upload"</span><span class="nt">&gt;&lt;/i&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"mt-20"</span><span class="nt">&gt;</span>点击或将文件拖拽到这里上传，最大支持20MB文件<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"js-progress"</span><span class="nt">&gt;&lt;/div&gt;</span></code></pre></div>

<h3 id="javascript-1">javascript</h3>

<div class="bd-example" data-example-id="">
<script>
var UploadHelper = ui.UploadHelper;
var wrap = document.querySelector('.js-progress');

UploadHelper('#upload-multi', {
  url: 'https://api.cooode.xyz/api/upload',
  start() {
    var item = this;
    wrap.appendChild(UploadHelper.createProgress(item));

    document.querySelector('#' + item.id + ' .cancel').addEventListener('click', function () {
      item.abort();
    });
    
    return true;
  },
  progress(pro) {
    document.querySelector('#' + this.id + ' .bar').style.width = pro + '%';
  },
  success(data) {
    if (data.code === 200) {
      document.querySelector('#' + this.id + ' .cancel').classList.add('hidden');
    }
  }
});
</script>
</div>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">UploadHelper</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">UploadHelper</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">wrap</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.js-progress</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">UploadHelper</span><span class="p">(</span><span class="dl">'</span><span class="s1">#upload-multi</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://api.cooode.xyz/api/upload</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">wrap</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">UploadHelper</span><span class="p">.</span><span class="nx">createProgress</span><span class="p">(</span><span class="nx">item</span><span class="p">));</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> .cancel</span><span class="dl">'</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">item</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">progress</span><span class="p">(</span><span class="nx">pro</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#</span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> .bar</span><span class="dl">'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">pro</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">%</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">success</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#</span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> .cancel</span><span class="dl">'</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">hidden</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span></code></pre></div>

<h2 id="config">Config</h2>

<blockquote>
  <p>UploadHelper是对Upload做了一个很简单的封装</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">Upload</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Upload</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">input[type="file"]</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">input</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">change</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// {HTMLInputElement} input</span>
  <span class="k">new</span> <span class="nx">Upload</span><span class="p">(</span><span class="nx">uploadUrl</span><span class="p">,</span> <span class="nx">input</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">files</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// input.files，即可以input参数传null，直接把files对象传过来</span>
    <span class="na">limit</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// 多文件上传一次添加的数量，0为无限制</span>
    <span class="na">fileType</span><span class="p">:</span> <span class="p">[],</span> <span class="c1">// ['.jpeg', '.png', '.gif']</span>
    <span class="na">fileName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// 请求url时的文件name值</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">json</span><span class="dl">'</span><span class="p">,</span>
    
    <span class="na">beforeInit</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="c1">// ...</span>
    <span class="c1">// 函数见下表</span>
  <span class="p">})</span>
<span class="p">});</span>
</code></pre></div></div>
<blockquote>
  <p>uploadContext是作为this的值使用，不是具体的参数，可能会调整</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>函数</th>
      <th>默认值</th>
      <th>参数</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>beforeInit</strong></td>
      <td>null</td>
      <td>callback</td>
      <td>整个上传初始化之前，函数中调用callback(true)会继续上传流程，否则结束</td>
    </tr>
    <tr>
      <td><strong>init</strong></td>
      <td>null</td>
      <td>this: uploadContext</td>
      <td>初始化上传文件数组，state变为0: init</td>
    </tr>
    <tr>
      <td><strong>start</strong></td>
      <td>function(){ return true; }</td>
      <td>this: uploadContext</td>
      <td>文件通过类型和大小的验证</td>
    </tr>
    <tr>
      <td><strong>beforeUploadStart</strong></td>
      <td>null</td>
      <td>uploadContexts, callback</td>
      <td>文件上传开始前，函数中调用callback(true)会继续上传，否则结束</td>
    </tr>
    <tr>
      <td><strong>beforeUpload</strong></td>
      <td>null</td>
      <td>this: uploadContext, uploadFileIndex, callback(next, data)</td>
      <td>单个文件上传开始前, 函数中调用callback(true)会继续上传，data会添加到当前文件上传的ajax请求中</td>
    </tr>
    <tr>
      <td><strong>progress</strong></td>
      <td>null</td>
      <td>this: uploadContext, progress</td>
      <td>上传进度</td>
    </tr>
    <tr>
      <td><strong>success</strong></td>
      <td>null</td>
      <td>this: uploadContext, responseData</td>
      <td>ajax上传有返回数据</td>
    </tr>
    <tr>
      <td><strong>error</strong></td>
      <td>null</td>
      <td>this: uploadContext, errorObject</td>
      <td>错误, 例如文件不存在等内部错误，文件扩展名不符，ajax请求错误，返回数据错误（例如dataType:json,但是格式不是json）</td>
    </tr>
    <tr>
      <td><strong>cancel</strong></td>
      <td>null</td>
      <td>this: uploadContext</td>
      <td>取消上传</td>
    </tr>
    <tr>
      <td><strong>complete</strong></td>
      <td>null</td>
      <td>this: uploadContext, status</td>
      <td>单个文件的上传流程结束，success，error，cancel后都会触发</td>
    </tr>
    <tr>
      <td><strong>finish</strong></td>
      <td>null</td>
      <td>uploadContexts</td>
      <td>所有文件的上传流程结束（多文件上传）</td>
    </tr>
  </tbody>
</table>

<div class="mt-20"></div>

<h3 id="uploadcontext对象属性">uploadContext对象属性</h3>

<blockquote>
  <p>uploadContexts为所有uploadContext对象组成的数组</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>name</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>index</strong></td>
      <td>文件index</td>
    </tr>
    <tr>
      <td><strong>id</strong></td>
      <td>文件唯一性标识</td>
    </tr>
    <tr>
      <td><strong>state</strong></td>
      <td>状态，可能的值：init/uploading/success/error/cancel</td>
    </tr>
    <tr>
      <td><strong>file</strong></td>
      <td>file对象</td>
    </tr>
    <tr>
      <td><strong>cancel</strong></td>
      <td>函数，调用可取消该文件的上传</td>
    </tr>
  </tbody>
</table>


        </div>
        <div class="page-menu-wrap">
          <div class="page-menu">
            <div class="page-need-css"></div>
            
            <div class="page-need-js"></div>
            
            <div class="page-menu-list"></div>
          </div>
        </div>
      </main>
    </div>
  </div>
  <footer></footer>



</body>

</html>